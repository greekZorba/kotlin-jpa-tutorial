# 다양한 연관관계 매핑 
## 다중성 
- 다대일: @ManyToOne
- 일대다: @OneToMany
- 일대일: @OneToOne
- 다대다: @ManyToMany - 실무에서 사용하면 안될 구조

---
## 단방향, 양방향 
- 테이블
  - 외래 키 하나로 양쪽 조인 가능 
  - 사실 방향이라는 개념이 없음 
- 객체 
  - 참조용 필드가 있는 쪽으로만 참조 가능 
  - 한쪽만 참조하면 단방향 
  - 양쪽이 서로 참조하면 양방향
  
---
## 연관관계의 주인 
- 테이블은 외래키 하나로 두 테이블이 연관관계를 맺음 
- 객체 양방향 관계는 A->B, B->A처럼 참조가 두 군데 
- 객체 양방향 관계는 참조가 두 군데 있음. 둘 중 테이블의 외래키를 관리할 곳을 지정해야함 
- 연관관계의 주인: 외래키를 관리하는 참조 
- 주인의 반대편: 외래키에 영향을 주지 않음. 단순 조회만 가능

---
## 다대일[N:1]
- 가장 많이 사용하는 연관관계 
- 다대일의 반대는 일대다

## 일대다[1:N]
### 일대다 단방향
- 권장하지 않음 
- 일대다(1:N)에서 일(1)이 연관관계의 주인 
- 테이블 일대다 관계는 항상 다(N)쪽이 외래키를 가지고 있음
- 객체와 테이블의 차이 때문에 반대편 테이블의 외래키를 관리하는 특이한 구조
- @JoinColumn을 꼭 사용해야함. 그렇지 않으면 조인 테이블 방식을 사용함(중간에 테이블을 하나 추가함)

### 일대다 단방향 단점 
- 엔티티가 관리하는 외래키가 다른 테이블에 있음 
- 연관관계 관리를 위해 추가로 Update SQL 실행 
- 일대다 단방향 매핑보다는 다대일 양방향 매핑을 사용하자.

### 일대다 양방향 정리 
- 공식적으로 존재하는 매핑은 아님 
- @JoinColumn(insertable = false, updatable = false)
- 읽기 전용 필드를 사용해서 양방향처럼 사용하는 방법 
- **다대일 양방향을 사용하자**

---
## 일대일 
- 일대일 관계는 그 반대도 일대일 
- 주 테이블이나 대상 테이블 중에 외래키 선택 가능 
  - 주 테이블에 외래키 
  - 대상 테이블에 외래키 
- 외래키에 데이터베이스 유니크(UNI) 제약조건 추가    
