# 양방향 연관관계와 연관관계의 주인 1 - 기본
## 객체와 테이블이 관계를 맺는 차이 
- 객체 연관관계 = 2개
  - 회원 -> 팀 연관관계 1개(단방향) 
  - 팀 -> 회원 연관관계 1개(단방향)
- 테이블 연관관계 = 1개 
  - 회원 <-> 팀의 연관관계 1개(양방향)
- 객체의 양방향 관계는 사실 양방향 관계가 아니라 서로 다른 단방향 관계 2개다 
---
## 연관관계의 주인(Owner)
### 양방향 매핑 규칙 
- 객체의 두 관계 중 하나를 연관관계의 주인으로 지정 
- 연관관계의 주인만이 외래키를 관리(등록, 수정)
- 주인이 아닌 쪽은 읽기만 가능 
- 주인은 mappedBy 속성 사용 X 
- 주인이 아니면 mappedBy 속성으로 주인 지정

### 누구를 주인으로? 
- 외래키가 있는 곳을 주인으로 정해라
  - @ManyToOne이 있는 쪽!(N:1일 때, N쪽인 곳이 연관관계의 주인)
- 예시에서는 Member가 주인이 되도록(Member와 Team 사이에서)  

---
# 양방향 연관관계와 연관관계의 주인 2 - 주의점, 정리
- 주인이 아닌 객체가 값을 넣어도 아무동작하지 않음. 
  - 예시에서 Team 객체에서 Member 값을 넣거나 바꿔도 소용없음(read only)
- 순수 객체 상태를 고려해서 항상 양쪽에 값을 설정하자. 
- 연관관계 편의 메서드를 생성하자.
  - Team 객체의 addMember처럼
- 양방향 매핑 시에 무한루프를 주의하자.
  - 예: toString(), lombok, JSON 생성 라이브러리
  
---
## 양방향 매핑 정리 
- 단방향 매핑만으로도 이미 연관관계 매핑은 완료해야함 
- 양방향 매핑은 반대방향으로 조회(객체 그래프 탐색) 기능이 추가된 것뿐 
- JPQL에서 역방향으로 탐색할 일이 많음
- 단방향 매핑을 잘하고 양방향은 필요할 때 추가해도 됨(테이블에 영향을 주지 않음)

---
## 연관관계의 주인을 정하는 기준 
- 비즈니스 로직을 기준으로 연관관계의 주인을 선택하면 안됨 
- 연관관계의 주인은 외래키의 위치를 기준으로 정해야함    
   
  